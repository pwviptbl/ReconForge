# Configuração personalizada para plugins - VarreduraIA
# Este arquivo pode ser usado para sobrescrever as configurações padrão

# Configuração de ativação/desativação de plugins
plugins:
  enabled:
    # Plugins de rede - ative/desative conforme necessário
    DNSResolverPlugin: true       # Resolução de DNS
    NmapScannerPlugin: true       # Scanner Nmap avançado
    PortScannerPlugin: false      # Scanner de portas básico (desabilitado - usar Nmap)
    RustScanPlugin: true          # Scanner de portas rápido
    SubdomainEnumeratorPlugin: true  # Enumeração de subdomínios
    
    # Plugins web - configurações para varreduras web
    WebScannerPlugin: true        # Scanner web básico
    TechnologyDetectorPlugin: true # Detector de tecnologias
    DirectoryScannerPlugin: true  # Scanner de diretórios
    WebVulnScannerPlugin: false   # Scanner de vulnerabilidades web (pode ser agressivo)
    
    # Plugins de vulnerabilidade - CUIDADO: podem ser invasivos
    NucleiScannerPlugin: true     # Scanner Nuclei
    SQLMapScannerPlugin: false    # SQLMap (MUITO AGRESSIVO - use com cuidado)
  
  # Configurações específicas por plugin
  config:
    # Configuração do DNS Resolver
    DNSResolverPlugin:
      timeout: 30
      max_subdomains: 100
      use_custom_dns: true
      dns_servers: ["8.8.8.8", "8.8.4.4", "1.1.1.1"]
      check_common_subdomains: true
      common_subdomains: 
        - www
        - mail
        - ftp
        - admin
        - test
        - dev
        - staging
        - api
        - app
        - portal
        - secure
        - shop
        - blog
        - support
        - help
        - docs
        - cdn
        - static
        - mobile
        - m
    
    # Configuração do Nmap Scanner
    NmapScannerPlugin:
      scan_type: "syn"           # syn, tcp, udp, connect
      timing: "T4"               # T0 (paranoid) até T5 (insane)
      max_ports: 1000
      script_scan: true
      service_detection: true
      os_detection: false        # Pode ser detectado como agressivo
      aggressive_scan: false     # -A flag do Nmap
      custom_scripts: []         # Scripts NSE personalizados
    
    # Configuração do Port Scanner (básico)
    PortScannerPlugin:
      timeout: 5
      max_threads: 50
      common_ports_only: true
      port_ranges: ["1-1000", "3000-3010", "8000-8100"]
    
    # Configuração do Web Scanner
    WebScannerPlugin:
      follow_redirects: true
      max_depth: 3
      user_agent: "Mozilla/5.0 (compatible; VarreduraIA/1.0)"
      timeout: 30
      max_pages: 100
      check_robots_txt: true
      check_sitemap: true
      check_common_files: true
    
    # Configuração do Technology Detector
    TechnologyDetectorPlugin:
      check_headers: true
      check_cookies: true
      check_html: true
      check_scripts: true
      check_meta_tags: true
      fingerprint_depth: "normal"  # basic, normal, deep
    
    # Configuração do Directory Scanner
    DirectoryScannerPlugin:
      wordlist: "wordlists/common.txt"
      threads: 20
      timeout: 10
      follow_redirects: false
      check_extensions: [".php", ".asp", ".aspx", ".jsp", ".do"]
      status_codes: [200, 301, 302, 403, 500]
    
    # Configuração do Nuclei Scanner
    NucleiScannerPlugin:
      severity_filter: ["medium", "high", "critical"]  # info, low, medium, high, critical
      max_templates: 500
      timeout: 300
      rate_limit: 100           # requests per second
      exclude_tags: ["intrusive", "dos"]
      include_tags: ["cve", "exposure", "misconfiguration"]
      update_templates: true
    
    # Configuração do SQLMap Scanner - USE COM EXTREMO CUIDADO
    SQLMapScannerPlugin:
      risk_level: 1             # 1-3 (1=baixo, 2=médio, 3=alto risco)
      level: 1                  # 1-5 (1=básico, 5=agressivo)
      timeout: 300
      threads: 1
      technique: "BEUSTQ"       # B=Boolean, E=Error, U=Union, S=Stacked, T=Time, Q=Query
      tamper_scripts: []        # Scripts de tamper para WAF bypass
      skip_urlencode: false
      skip_static: true
      smart: true
    
    # Configuração do Subdomain Enumerator
    SubdomainEnumeratorPlugin:
      wordlist: "wordlists/subdomains.txt"
      dns_servers: ["8.8.8.8", "8.8.4.4"]
      threads: 50
      timeout: 10
      check_wildcard: true
      recursive_depth: 2

# Configurações globais que afetam o comportamento dos plugins
network:
  timeout: 15                   # Timeout padrão para conexões
  max_threads: 100             # Máximo de threads simultâneas
  delay: 0.5                   # Delay entre requests (segundos)
  user_agent: "Mozilla/5.0 (compatible; VarreduraIA/1.0)"

# Configurações de output
output:
  data_dir: "data"
  timestamp_format: "%Y%m%d_%H%M%S"
  max_results: 100
  save_raw_output: true        # Salvar output bruto dos tools
  
# Configurações de logging
logging:
  level: "INFO"               # DEBUG, INFO, WARNING, ERROR
  file: "logs/varredura.log" # null para não salvar em arquivo
  max_size_mb: 50
  backup_count: 10
